<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giáo Họ Trung Đồng</title>
    <meta name="description" content="Nhà Thờ Giáo Họ Trung Đồng - Giáo Xứ Lạc Thành - Giáo Phận Bùi Chu">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .container { flex: 1; }
        footer { position: relative; width: 100%; bottom: 0; }
        .pagination { justify-content: center; margin-top: 20px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Giáo Họ Trung Đồng</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a class="nav-link" href="#about">Giới Thiệu</a></li>
                <li class="nav-item"><a class="nav-link" href="#services">Hoạt Động</a></li>
                <li class="nav-item"><a class="nav-link" href="#contact">Liên Hệ</a></li>
            </ul>
        </div>
    </nav>

    <section id="donation" class="section bg-light">
        <div class="container">
            <h2 class="text-center">Danh Sách Ủng Hộ</h2>
            <div class="mb-4">
                <input type="text" id="name" class="form-control mb-2" placeholder="Họ và Tên">
                <input type="text" id="parish" class="form-control mb-2" placeholder="Giáo Họ">
                <input type="number" id="amount" class="form-control mb-2" placeholder="Số Tiền Ủng Hộ">
                <button class="btn btn-primary" onclick="addDonor()">Thêm Người Ủng Hộ</button>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered table-striped">
                    <thead class="thead-dark">
                        <tr>
                            <th>STT</th>
                            <th>Họ và Tên</th>
                            <th>Giáo Họ</th>
                            <th>Số Tiền Ủng Hộ</th>
                        </tr>
                    </thead>
                    <tbody id="donationTable"></tbody>
                </table>
            </div>
        </div>
    </section>

    <footer class="text-center py-3 bg-dark text-white">
        <p>&copy; 2024 Giáo Họ Trung Đồng. All rights reserved.</p>
    </footer>

    <script>
        const apiUrl = 'https://script.google.com/macros/s/AKfycbw80UPzyIwEiiLjcMbZrTHu-ulflSRby0GOiriCrXaPyZPgQQjJn134WQZFSfN68z4v5g/exec'; // Thay thế bằng URL của Google Apps Script

        function renderTable() {
            fetch(`${apiUrl}?action=get`)
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.getElementById('donationTable');
                    tableBody.innerHTML = '';
                    data.forEach((donor, index) => {
                        const row = `<tr>
                            <td>${index + 1}</td>
                            <td>${donor.name}</td>
                            <td>${donor.parish}</td>
                            <td>${donor.amount}</td>
                        </tr>`;
                        tableBody.innerHTML += row;
                    });
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        function addDonor() {
            const name = document.getElementById('name').value;
            const parish = document.getElementById('parish').value;
            const amount = document.getElementById('amount').value;

            if (name && parish && amount) {
                const newDonor = { name, parish, amount };

                fetch(apiUrl, {
                    method: 'POST',
                    body: JSON.stringify({ action: 'add', ...newDonor }),
                    headers: { 'Content-Type': 'application/json' }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Thêm người ủng hộ thành công!');
                        renderTable();
                    }
                })
                .catch(error => console.error('Error adding donor:', error));

                document.getElementById('name').value = '';
                document.getElementById('parish').value = '';
                document.getElementById('amount').value = '';
            } else {
                alert('Vui lòng nhập đầy đủ thông tin!');
            }
        }

        document.addEventListener('DOMContentLoaded', renderTable);
    </script>
</body>
</html>
